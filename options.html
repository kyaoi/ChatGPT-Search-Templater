<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ChatGPT Search Templater 設定</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        line-height: 1.5;
        --accent: #4f46e5;
        --border: rgba(128, 128, 128, 0.3);
        --surface: rgba(255, 255, 255, 0.7);
        --danger: #dc2626;
      }

      body {
        margin: 0;
        background: var(--surface);
      }

      main {
        max-width: 960px;
        margin: 0 auto;
        padding: 24px 20px 40px;
      }

      h1,
      h2 {
        margin: 0 0 12px;
      }

      h2 {
        margin-top: 32px;
        font-size: 1.1rem;
      }

      p.description {
        margin: 0 0 24px;
        color: rgba(60, 60, 67, 0.7);
        font-size: 0.95rem;
      }

      fieldset {
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px 20px;
        margin: 0;
        background: rgba(255, 255, 255, 0.65);
      }

      .grid {
        display: grid;
        gap: 16px;
      }

      .template-grid {
        display: grid;
        gap: 20px;
      }

      @media (min-width: 900px) {
        .template-grid {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      label {
        display: flex;
        flex-direction: column;
        gap: 4px;
        font-size: 0.9rem;
        margin-bottom: 12px;
      }

      input[type="text"],
      input[type="number"],
      textarea,
      select {
        appearance: none;
        border-radius: 8px;
        border: 1px solid var(--border);
        padding: 10px 12px;
        font-size: 0.95rem;
      }

      textarea {
        resize: vertical;
        min-height: 94px;
      }

      input[type="checkbox"] {
        transform: scale(1.1);
      }

      .template-card {
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 16px 18px 18px;
        background: rgba(255, 255, 255, 0.8);
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .template-card header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
      }

      .template-card header .title-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
        flex: 1;
      }

      .template-card header .title-group input[type="text"] {
        width: 100%;
      }

      .switch {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
      }

      .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin: 8px 0 4px;
      }

      .inline-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      .preview {
        background: rgba(15, 23, 42, 0.06);
        border-radius: 8px;
        padding: 12px;
        font-family: "SFMono-Regular", Menlo, Consolas, "Liberation Mono", monospace;
        font-size: 0.8rem;
        word-break: break-all;
        color: rgba(15, 23, 42, 0.8);
      }

      .preview--query {
        white-space: pre-wrap;
        word-break: break-word;
      }

      .preview-group {
        display: grid;
        gap: 10px;
      }

      .warning {
        color: var(--danger);
        font-size: 0.8rem;
        margin: 0;
      }

      .actions {
        margin-top: 28px;
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      button {
        border-radius: 999px;
        border: none;
        padding: 10px 18px;
        font-size: 0.95rem;
        cursor: pointer;
        transition: transform 0.1s ease, box-shadow 0.1s ease;
      }

      button.primary {
        background: var(--accent);
        color: #fff;
      }

      button.secondary {
        background: rgba(15, 23, 42, 0.1);
        color: rgba(15, 23, 42, 0.8);
      }

      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .status {
        font-size: 0.85rem;
        color: rgba(22, 101, 52, 0.9);
        min-height: 1.2rem;
      }
    </style>
  </head>
  <body>
    <main>
      <h1>ChatGPT Search Templater</h1>
      <p class="description">テンプレートに選択テキストを差し込み、chatgpt.com を素早く開きます。</p>

      <form id="settingsForm" class="grid" autocomplete="off">
        <fieldset>
          <legend>全体設定</legend>
          <label>
            コンテキストメニュー名
            <input id="parentMenuTitle" type="text" name="parentMenuTitle" />
          </label>
          <label>
            HARD_LIMIT（URL最大文字数）
            <input id="hardLimit" type="number" name="hardLimit" min="100" step="100" />
          </label>
        </fieldset>

        <section>
          <h2>テンプレート（最大2件）</h2>
          <div id="templateCards" class="template-grid">
            <article class="template-card" data-template-id="template-1">
              <header>
                <label class="switch">
                  <input type="checkbox" data-field="enabled" />
                  有効にする
                </label>
                <div class="title-group">
                  <input type="text" data-field="label" placeholder="メニュー表示名" />
                  <small>コンテキストメニューに表示されます。</small>
                </div>
              </header>

              <label>
                テンプレートURL
                <input type="text" data-field="url" placeholder="https://chatgpt.com/?q={TEXT}" />
              </label>

              <label>
                検索内容テンプレート
                <textarea data-field="queryTemplate" placeholder="以下の文章を日本語に直してください。\n\n{TEXT}"></textarea>
                <small>
                  {TEXT} / {選択した文字列} が選択テキストに置き換わります。リテラル {TEXT} を表示したい場合は
                  {{TEXT}} と入力してください。
                </small>
              </label>

              <div class="checkbox-group">
                <label class="switch">
                  <input type="checkbox" data-field="hintsSearch" />
                  Searchヒント（hints=search）
                </label>
                <label class="switch">
                  <input type="checkbox" data-field="temporaryChat" />
                  一時チャット（temporary-chat=true）
                </label>
              </div>

              <div class="inline-group">
                <label style="flex: 1">
                  モデル
                  <select data-field="model">
                    <option value="gpt-4o">gpt-4o</option>
                    <option value="o3">o3</option>
                    <option value="gpt-5">gpt-5</option>
                    <option value="custom">カスタム</option>
                  </select>
                </label>
                <label style="flex: 1" data-role="custom-model">
                  カスタムモデル名
                  <input type="text" data-field="customModel" placeholder="custom-model-id" />
                </label>
              </div>

              <div class="preview-group">
                <div class="preview preview--query" data-role="query-preview"></div>
                <div class="preview" data-role="preview"></div>
              </div>
              <p class="warning" data-role="warning"></p>
            </article>

            <article class="template-card" data-template-id="template-2">
              <header>
                <label class="switch">
                  <input type="checkbox" data-field="enabled" />
                  有効にする
                </label>
                <div class="title-group">
                  <input type="text" data-field="label" placeholder="メニュー表示名" />
                  <small>コンテキストメニューに表示されます。</small>
                </div>
              </header>

              <label>
                テンプレートURL
                <input type="text" data-field="url" placeholder="https://chatgpt.com/?q={TEXT}" />
              </label>

              <label>
                検索内容テンプレート
                <textarea data-field="queryTemplate" placeholder="以下の文章を日本語に直してください。\n\n{TEXT}"></textarea>
                <small>
                  {TEXT} / {選択した文字列} が選択テキストに置き換わります。リテラル {TEXT} を表示したい場合は
                  {{TEXT}} と入力してください。
                </small>
              </label>

              <div class="checkbox-group">
                <label class="switch">
                  <input type="checkbox" data-field="hintsSearch" />
                  Searchヒント（hints=search）
                </label>
                <label class="switch">
                  <input type="checkbox" data-field="temporaryChat" />
                  一時チャット（temporary-chat=true）
                </label>
              </div>

              <div class="inline-group">
                <label style="flex: 1">
                  モデル
                  <select data-field="model">
                    <option value="gpt-4o">gpt-4o</option>
                    <option value="o3">o3</option>
                    <option value="gpt-5">gpt-5</option>
                    <option value="custom">カスタム</option>
                  </select>
                </label>
                <label style="flex: 1" data-role="custom-model">
                  カスタムモデル名
                  <input type="text" data-field="customModel" placeholder="custom-model-id" />
                </label>
              </div>

              <div class="preview-group">
                <div class="preview preview--query" data-role="query-preview"></div>
                <div class="preview" data-role="preview"></div>
              </div>
              <p class="warning" data-role="warning"></p>
            </article>
          </div>
        </section>

        <div class="actions">
          <button type="submit" class="primary" id="saveButton">保存する</button>
          <button type="button" class="secondary" id="resetButton">初期設定に戻す</button>
          <span class="status" id="statusText"></span>
        </div>
      </form>
    </main>
    <script type="module" src="dist/options.js"></script>
  </body>
</html>
